<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PASAR ROBLOX - Official Full Store</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        :root { --primary: #2b3990; --secondary: #f3f4f6; --accent: #ff4d4d; --success: #25D366; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
        body { background: #f8f9fa; color: #333; padding-bottom: 100px; }
        .hidden { display: none !important; }
        .rekber-container { background: linear-gradient(135deg, #25d366, #128c7e); color: white; padding: 12px 20px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; cursor: pointer; border: 2px solid #ffffff33; }
        .rekber-content { display: flex; align-items: center; gap: 12px; }
        .animate-glow { animation: rekberPulse 2s infinite; }
        @keyframes rekberPulse { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(37, 211, 102, 0.7); } 70% { transform: scale(1.02); box-shadow: 0 0 0 15px rgba(37, 211, 102, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(37, 211, 102, 0); } }
        header { background: white; padding: 12px 20px; position: sticky; top: 0; z-index: 1000; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .logo { font-weight: 900; color: var(--primary); font-size: 1.3rem; display: flex; align-items: center; gap: 8px; }
        .btn-top-acc { background: var(--primary); color: white; padding: 6px 15px; border-radius: 20px; font-weight: 700; font-size: 0.8rem; cursor: pointer; }
        .banner-container { padding: 15px; background: white; }
        .banner-wrapper { width: 100%; overflow: hidden; border-radius: 15px; position: relative; }
        .banner-track { display: flex; transition: 0.5s ease-in-out; width: 300%; }
        .banner-track img { width: 100%; height: 160px; object-fit: cover; }
        .page { padding: 15px; }
        .game-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; }
        .game-card { background: white; border-radius: 15px; padding: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.03); cursor: pointer; border: 1.5px solid transparent; }
        .game-card img { width: 100%; aspect-ratio: 1/1; border-radius: 12px; margin-bottom: 8px; object-fit: cover; }
        .game-card p { font-size: 0.7rem; font-weight: 700; }
        .game-card.selected { border-color: var(--primary); background: #f0f4ff; }
        .fab-cs { position: fixed; bottom: 85px; right: 20px; width: 55px; height: 55px; background: var(--success); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 1.8rem; box-shadow: 0 4px 15px rgba(0,0,0,0.2); z-index: 3000; cursor: pointer; animation: pulse 2s infinite; }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }
        .bottom-sheet { position: fixed; bottom: 0; width: 100%; background: white; border-radius: 25px 25px 0 0; padding: 25px; z-index: 2000; box-shadow: 0 -5px 25px rgba(0,0,0,0.15); transform: translateY(100%); transition: 0.3s; max-height: 85vh; overflow-y: auto; }
        .bottom-sheet.active { transform: translateY(0); }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1900; display: none; }
        .overlay.active { display: block; }
        .menu-box { background: white; margin-bottom: 15px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); overflow: hidden; }
        .menu-item { padding: 18px; border-bottom: 1px solid #f5f5f5; display: flex; justify-content: space-between; align-items: center; cursor: pointer; }
        .input-uid, .input-file { padding: 12px; border-radius: 10px; border: 1px solid #ddd; width: 100%; outline: none; margin: 10px 0; font-size: 0.9rem; }
        .btn-confirm { width: 100%; background: var(--primary); color: white; padding: 16px; border: none; border-radius: 12px; font-weight: 800; margin-top: 10px; cursor: pointer; }
        .btn-wa { background: var(--success); }
        .qris-img { width: 220px; display: block; margin: 10px auto; border: 2px solid #eee; padding: 5px; border-radius: 10px; }
        .nav-bar { position: fixed; bottom: 0; width: 100%; background: white; display: flex; border-top: 1px solid #eee; padding: 10px 0; z-index: 1500; }
        .nav-item { flex: 1; text-align: center; color: #999; font-size: 0.7rem; cursor: pointer; }
        .nav-item.active { color: var(--primary); font-weight: 800; }
        .nav-item i { font-size: 1.2rem; display: block; margin-bottom: 4px; }
    </style>
</head>
<body>

    <div id="overlay" class="overlay" onclick="closeAll()"></div>

    <div class="fab-cs" onclick="contactCS()">
        <i class="fab fa-whatsapp"></i>
    </div>

    <header>
        <div class="logo"><i class="fas fa-bolt"></i> PASAR ROBLOX</div>
        <div id="acc-btn" class="btn-top-acc" onclick="nav('profile', document.querySelectorAll('.nav-item')[4])">Masuk</div>
    </header>

    <main id="page-home" class="page-content">
        <div class="banner-container">
            <div class="banner-wrapper">
                <div class="banner-track" id="bannerTrack">
                    <img src="https://image2url.com/r2/default/images/1771501486399-802485da-7927-4662-bd1e-845390ccc424.jpg">
                    <img src="https://image2url.com/r2/default/images/1771501571555-a6078f47-61e0-4780-b79e-1fb01d620000.jpg">
                    <img src="https://image2url.com/r2/default/images/1771502261299-376b9d29-8a2c-4d6c-94fd-520ec9c0bb60.jpg">
                </div>
            </div>
        </div>
        <div class="page">
            <h3 style="margin-bottom: 15px;">üî• Produk Unggulan</h3>
            <div class="game-grid" id="main-game-list"></div>
            
            <div style="margin-top: 30px;">
                <div style="background: white; padding: 20px; border-radius: 15px; border-left: 5px solid var(--primary); box-shadow: 0 5px 15px rgba(0,0,0,0.05); margin-bottom: 25px;">
                    <h4 style="margin-bottom: 8px; color: var(--primary);">üìù Tentang PASAR ROBLOX</h4>
                    <p style="font-size: 0.8rem; line-height: 1.5; color: #666;">Selamat datang di PASAR ROBLOX. Transaksi aman dan proses kilat.</p>
                </div>
            </div>
        </div>
    </main>

    <main id="page-nokos" class="page-content hidden">
        <div class="page">
            <h3 style="margin-bottom: 20px;">üì± Layanan NOKOS (OTP)</h3>
            <div class="game-grid" style="grid-template-columns: 1fr 1fr;">
                <div class="game-card" onclick="selectNokos('WhatsApp', 4000, this)">
                    <i class="fab fa-whatsapp" style="font-size: 2.5rem; color: var(--success);"></i>
                    <p>WhatsApp</p><b>Rp 4.000</b>
                </div>
                <div class="game-card" onclick="selectNokos('Telegram', 8000, this)">
                    <i class="fab fa-telegram" style="font-size: 2.5rem; color: #0088cc;"></i>
                    <p>Telegram</p><b>Rp 8.000</b>
                </div>
            </div>
            <button class="btn-confirm" onclick="addToCart()">Lanjutkan Pesanan</button>
        </div>
    </main>

    <main id="page-promo" class="page-content hidden">
        <div class="page">
            <div class="rekber-container animate-glow" onclick="contactCS()">
                <div class="rekber-content">
                    <i class="fab fa-whatsapp" style="font-size: 1.5rem;"></i>
                    <span><b>Rekber Mas R</b><br><small>Terpercaya & Aman ‚úÖ</small></span>
                </div>
                <i class="fas fa-chevron-right"></i>
            </div>
            <h3 style="margin: 20px 0 15px;">üî• Promo Spesial Hari Ini</h3>
            <div class="game-grid" id="promo-list-container">
                </div>
        </div>
    </main>

    <main id="page-cart" class="page-content hidden">
        <div class="page">
            <h3>üõí Checkout Pesanan</h3>
            <div id="cart-box" class="menu-box" style="margin: 15px 0; padding: 20px;">
                <p style="text-align: center; color: #999;">Keranjang Kosong</p>
            </div>
            <div id="payment-section" class="hidden">
                <div class="menu-item" onclick="openQrisModal()">
                    <span><i class="fas fa-qrcode"></i> QRIS Otomatis</span>
                    <b class="final-price"></b>
                </div>
                <button class="btn-confirm btn-wa" onclick="finishOrder('WhatsApp Direct')">KONFIRMASI VIA WHATSAPP</button>
            </div>
        </div>
    </main>

    <main id="page-profile" class="page-content hidden">
        <div id="auth-screen" style="padding: 60px 25px; text-align: center;">
            <h2 id="auth-title">Masuk Member</h2>
            <input type="text" id="usernameIn" placeholder="Username" class="input-uid">
            <button class="btn-confirm" onclick="prosesAuth()" id="btn-auth">MASUK SEKARANG</button>
            <p style="margin-top:15px; font-size:14px;">Belum punya akun? <a href="#" onclick="toggleAuth()">Daftar</a></p>
        </div>
        
        <div id="account-screen" class="hidden">
            <div style="background:var(--primary); color:white; padding:40px 20px; text-align:center; border-radius:0 0 30px 30px;">
                <div style="width:70px; height:70px; background:white; border-radius:50%; margin:0 auto 15px; display:flex; align-items:center; justify-content:center; color:var(--primary); font-size: 1.5rem;"><i class="fas fa-user"></i></div>
                <h3 id="displayUname">User</h3>
                <div id="saldo-box" style="margin-top:10px; background:rgba(255,255,255,0.2); padding:10px; border-radius:10px;">
                    <small>Saldo Anda</small>
                    <h2 id="user-saldo">Rp 0</h2>
                </div>
            </div>
            <div class="menu-box" style="margin:20px 15px;">
                <div class="menu-item" onclick="alert('Fitur segera hadir!')"><b><i class="fas fa-history"></i> Riwayat Pembelian</b></div>
                <div class="menu-item" style="color:red;" onclick="doLogout()"><span>Logout Akun</span><i class="fas fa-sign-out-alt"></i></div>
            </div>
        </div>
    </main>

    <div id="sheet" class="bottom-sheet">
        <h3 id="sheet-title">Pilih Produk</h3>
        <input type="text" id="target-id" placeholder="Masukkan Link / ID" class="input-uid">
        <div class="game-grid" id="nominal-grid" style="grid-template-columns: 1fr 1fr; margin-bottom:15px;"></div>
        <button class="btn-confirm" onclick="addToCart()">BELI SEKARANG</button>
    </div>

    <div id="qris-modal" class="bottom-sheet">
        <h3 style="text-align:center;">Scan QRIS Pembayaran</h3>
        <img src="https://image2url.com/r2/default/images/1771500211350-b6054fe5-ace8-4d0d-a5f7-6de988fe0b71.png" class="qris-img">
        <p style="text-align:center; font-weight:800; color:var(--primary);" class="final-price"></p>
        <button class="btn-confirm btn-wa" onclick="finishOrder('QRIS')">SUDAH TRANSFER</button>
    </div>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="nav('home', this)"><i class="fas fa-home"></i>Home</div>
        <div class="nav-item" onclick="nav('cart', this)"><i class="fas fa-shopping-cart"></i>Keranjang</div>
        <div class="nav-item" onclick="nav('nokos', this)"><i class="fas fa-comment-dots"></i>Nokos</div>
        <div class="nav-item" onclick="nav('promo', this)"><i class="fas fa-fire"></i>Promosi</div> 
        <div class="nav-item" onclick="nav('profile', this)"><i class="fas fa-user"></i>Profil</div>
    </nav>

    <div id="buy-notification" style="position: fixed; bottom: 100px; left: -300px; background: white; padding: 10px 15px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); display: flex; align-items: center; gap: 10px; z-index: 9999; transition: 0.5s; border-left: 4px solid var(--primary);">
        <i class="fas fa-shopping-bag" style="color:var(--primary)"></i>
        <div>
            <p id="notif-text" style="font-size: 0.7rem; margin: 0; font-weight: bold;"></p>
            <p style="font-size: 0.6rem; margin: 0; color: #888;">Baru saja</p>
        </div>
    </div>

    <script>
        const fbURL = 'https://pasar-roblox-default-rtdb.asia-southeast1.firebasedatabase.app';
        const noWA = "6281234567890";
        let isLoginMode = true;
        let cart = {};

        // DATABASE LOKAL (UNTUK HOME)
        const db = {
            "JPM PAKET HEMAT": { banner: "https://image2url.com/r2/default/images/1771597503989-2a6288eb-2632-4045-ac24-bdd9a01c8d89.jpeg", items: [{q:"10 MEMBER", p:1500}, {q:"100 MEMBER", p:15000}] },
            "JPM SUPER KILAT": { banner: "https://image2url.com/r2/default/images/1771596990082-36b58678-9472-46ce-b56a-482d21c5f606.jpg", items: [{q:"70 Diamonds", p:10000}] }
        };

        // 1. FUNGSI NAVIGASI (SANGAT PENTING)
        function nav(id, el) {
            document.querySelectorAll('.page-content').forEach(m => m.classList.add('hidden'));
            const target = document.getElementById('page-' + id);
            if(target) target.classList.remove('hidden');

            document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active'));
            if(el) el.classList.add('active');
            window.scrollTo(0,0);
        }

        // 2. FUNGSI AUTH (FIREBASE)
        function toggleAuth() {
            isLoginMode = !isLoginMode;
            document.getElementById('auth-title').innerText = isLoginMode ? 'Masuk Member' : 'Daftar Member';
            document.getElementById('btn-auth').innerText = isLoginMode ? 'MASUK SEKARANG' : 'DAFTAR SEKARANG';
        }

        async function prosesAuth() {
            const user = document.getElementById('usernameIn').value.trim().toLowerCase();
            if(!user) return alert("Isi username!");

            try {
                const res = await fetch(`${fbURL}/users/${user}.json`);
                const data = await res.json();

                if(isLoginMode) {
                    if(data) {
                        localStorage.setItem('userLogin', user);
                        location.reload();
                    } else { alert("User tidak ditemukan!"); }
                } else {
                    if(data) return alert("Username sudah ada!");
                    await fetch(`${fbURL}/users/${user}.json`, { method: 'PUT', body: JSON.stringify({ saldo: 0, joinDate: new Date().toLocaleDateString() }) });
                    alert("Berhasil Daftar! Silakan Login.");
                    toggleAuth();
                }
            } catch(e) { alert("Error koneksi!"); }
        }

        function cekStatusLogin() {
            const user = localStorage.getItem('userLogin');
            if(user) {
                document.getElementById('displayUname').innerText = user.toUpperCase();
                document.getElementById('acc-btn').innerText = user.toUpperCase();
                document.getElementById('auth-screen').classList.add('hidden');
                document.getElementById('account-screen').classList.remove('hidden');
                fetch(`${fbURL}/users/${user}/saldo.json`).then(r => r.json()).then(s => {
                    document.getElementById('user-saldo').innerText = "Rp " + (s || 0).toLocaleString();
                });
            }
        }

        function doLogout() {
            if(confirm("Keluar akun?")) { localStorage.removeItem('userLogin'); location.reload(); }
        }

        // 3. FUNGSI PRODUK PROMOSI (FIREBASE)
        async function loadPromoFirebase() {
            const container = document.getElementById('promo-list-container');
            try {
                const res = await fetch(`${fbURL}/produk_promo.json`);
                const data = await res.json();
                if(!data) return container.innerHTML = "<p>Belum ada promo.</p>";
                
                container.innerHTML = Object.keys(data).map(id => `
                    <div class="game-card" onclick="window.open('https://wa.me/${noWA}?text=Beli+${data[id].nama}')">
                        <img src="${data[id].gambar}">
                        <p>${data[id].nama}</p>
                        <b style="color:var(--success)">${data[id].harga}</b>
                    </div>
                `).join('');
            } catch(e) { console.log("Gagal muat promo"); }
        }

        // 4. FUNGSI NOTIFIKASI PALSU
        function showNotif() {
            const names = ["Andi", "Siska", "Budi", "Zidan"];
            const items = ["JPM Super", "Nokos WA", "Sewa Bot"];
            document.getElementById('notif-text').innerHTML = `${names[Math.floor(Math.random()*names.length)]} baru saja membeli <br><span style="color:var(--primary)">${items[Math.floor(Math.random()*items.length)]}</span>`;
            document.getElementById('buy-notification').style.left = "20px";
            setTimeout(() => { document.getElementById('buy-notification').style.left = "-300px"; }, 4000);
        }

        // FUNGSI LAINNYA
        function openSheet(name) {
            cart = { game: name };
            document.getElementById('sheet-title').innerText = name;
            document.getElementById('nominal-grid').innerHTML = db[name].items.map(i => `
                <div class="game-card" onclick="selectNom('${i.q}', ${i.p}, this)"><b>${i.q}</b><br><small>Rp ${i.p.toLocaleString()}</small></div>
            `).join('');
            document.getElementById('sheet').classList.add('active');
            document.getElementById('overlay').classList.add('active');
        }

        function selectNom(q, p, el) {
            document.querySelectorAll('#nominal-grid .game-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            cart.qty = q; cart.price = p;
        }

        function selectNokos(app, p, el) {
            document.querySelectorAll('#page-nokos .game-card').forEach(c => c.classList.remove('selected'));
            el.classList.add('selected');
            cart = { game: "Nokos " + app, qty: "OTP", price: p, target: "Sistem" };
        }

        function addToCart() {
            if(!cart.qty) return alert("Pilih produk!");
            cart.target = document.getElementById('target-id').value || "User";
            document.getElementById('cart-box').innerHTML = `<b>${cart.game}</b><br>${cart.qty}<br>Total: Rp ${cart.price.toLocaleString()}`;
            document.querySelectorAll('.final-price').forEach(b => b.innerText = "Rp " + cart.price.toLocaleString());
            document.getElementById('payment-section').classList.remove('hidden');
            closeAll(); nav('cart', document.querySelectorAll('.nav-item')[1]);
        }

        function openQrisModal() { document.getElementById('qris-modal').classList.add('active'); document.getElementById('overlay').classList.add('active'); }
        function closeAll() { document.querySelectorAll('.bottom-sheet, .overlay').forEach(el => el.classList.remove('active')); }
        function contactCS() { window.open(`https://wa.me/${noWA}?text=Halo+Admin+Pasar+Roblox...`); }
        function finishOrder(m) { alert("Pesanan diteruskan ke WA!"); window.open(`https://wa.me/${noWA}?text=ORDER:${cart.game}-${cart.qty}`); }

        function init() {
            document.getElementById('main-game-list').innerHTML = Object.keys(db).map(name => `
                <div class="game-card" onclick="openSheet('${name}')"><img src="$
